<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Liga de Béisbol de Cartagena</title>
  <link rel="stylesheet" href="/css/index.css">
</head>
<body>
	<header class="hero-compact" id="inicio">
	  <div class="hero-inner">
	    <img src="https://i.ibb.co/Bz7h7YK/Recurso-5-100.jpg" alt="Liga de Béisbol de Cartagena" class="hero-logo">
	    <div class="hero-text">
	      <h1 class="hero-title">Liga de Béisbol de Cartagena</h1>
	      <p class="hero-subtitle">Gestión oficial del béisbol en Cartagena</p>
	      <div class="hero-stats">
	        <span class="stat-capsule">
				<div th:if="${temporada != null}">
				    Cantidad equipos:
				    <span th:text="${temporada.equiposParticipantes != null ? temporada.equiposParticipantes.size() : 0}"></span>
				</div>
	        </span>
	        <span class="stat-capsule">
	          <strong class="stat-number">2025</strong> Temporada
	        </span>
	      </div>
	    </div>
	  </div>
	</header>

  <nav class="main-nav">
    <div class="nav-container">
		<a href="/" class="nav-link">
		Volver
		</a>
      <a href="/temporadas-jugadores" class="nav-link">
        Jugadores
      </a>
      <a href="/listar-partidos" class="nav-link">
        Partidos
      </a>

      <!-- BOTÓN DE INICIAR SESIÓN (solo si NO está loggeado) -->
      <a href="/admin" class="nav-link login-btn" 
         th:unless="${#authorization.expression('isAuthenticated()')}">
        Iniciar Sesión
      </a>

    <!-- USUARIO AUTENTICADO -->
    <div class="user-section" th:if="${#authorization.expression('isAuthenticated()')}">
      <span class="welcome-msg"
            th:if="${#authentication.principal instanceof T(org.springframework.security.oauth2.core.user.DefaultOAuth2User)}"
            th:text="'Bienvenido, ' + ${#authentication.principal.attributes['name']} + '!'">
      </span>

      <span class="welcome-msg"
            th:if="${#authentication.principal instanceof T(org.springframework.security.core.userdetails.User)}"
            th:text="'Bienvenido, ' + ${#authentication.name} + '!'">
      </span>

      <!-- BOTÓN PANEL ADMIN (SOLO SI ES ADMIN) -->
      <a href="/admin" class="nav-link admin-panel-btn"
         th:if="${#authorization.expression('hasRole(''ADMIN'')')}">
        Panel Admin
      </a>

      <!-- CERRAR SESIÓN -->
      <form th:action="@{/logout}" method="post" class="logout-form">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        <button type="submit" class="logout-btn">Cerrar sesión</button>
      </form>
    </div>
    </div>
  </nav>

  <main class="contenido" id="equipos">
	<h1>Predicción de Juego</h1>

	<form action="/prediccion/resultado" method="post">
	    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

	    <label>Local o Visitante:</label>
	    <select name="localVisitante">
	        <option value="Local">Local</option>
	        <option value="Visitante">Visitante</option>
	    </select>
		<br><br>

	    <label>Racha últimos 3:</label>
	    <input type="number" name="rachaUlt3" step="1">
		
		<br><br>

	    <label>Promedio carreras a favor:</label>
	    <input type="number" name="promFavor" step="0.01">
		
		<br><br>

	    <label>Promedio carreras en contra:</label>
	    <input type="number" name="promContra" step="0.01">

		<br><br>
		
	    <label>Fuerza del rival:</label>
	    <select name="rivalFuerza">
	        <option value="Alta">Alta</option>
	        <option value="Media">Media</option>
	        <option value="Baja">Baja</option>
	    </select>
		
		<br><br>

	    <button type="submit">Predecir</button>
	</form>

	<hr>

	<div th:if="${prediccion}">
	    <h2>Resultado: <span th:text="${prediccion}"></span></h2>
	</div>

	<div th:if="${error}">
	    <h2 style="color:red" th:text="${error}"></h2>
	</div>

  </main>

  <footer>
    <p>&copy; 2025 Liga de Béisbol de Cartagena</p>
  </footer>
  
  <style>  footer {
    position: fixed;
    bottom: 0;
    width: 100%;
  }
</style>
  
</body>
</html>
